# Top 30 Cities Rediscovery Action Plan

## Overview
Enhanced rediscovery script for the 30 most populous cities (including Seattle) with:
- **9 search queries** (matching original discovery script for better coverage)
- **Optimized APIs** (cost savings from OPTIMIZED script)
- **Complete data enrichment** (description, image_url for all new venues)
- **Database upsert** (ready for deployment)

## ‚úÖ Completed Steps

### 1. ‚úÖ Identified Top 30 Cities from Recent Rediscovery Results
Found the 30 most populous cities from the recent rediscovery run (249 cities processed):
1. New York, NY (8.8M)
2. Phoenix, AZ (1.6M)
3. Philadelphia, PA (1.6M)
4. **Seattle, WA (737K)** ‚Üê Target city (#4!)
5. Portland, OR (653K)
6. Milwaukee, WI (577K)
7. Tucson, AZ (543K)
8. Raleigh, NC (468K)
9. Virginia Beach, VA (459K)
10. Miami, FL (442K)
11. Minneapolis, MN (430K)
12. Tampa, FL (385K)
13. New Orleans, LA (384K)
14. Newark, NJ (312K)
15. Orlando, FL (308K)
16. Pittsburgh, PA (303K)
17. St. Louis, MO (302K)
18. Madison, WI (270K)
19. Reno, NV (264K)
20. St. Petersburg, FL (258K)
21. Lubbock, TX (257K)
22. Louisville, KY (246K)
23. Norfolk, VA (238K)
24. Spokane, WA (229K)
25. Richmond, VA (227K)
26. Tacoma, WA (219K)
27. Rochester, NY (211K)
28. Port St. Lucie, FL (205K)
29. Montgomery, AL (201K)
30. Salt Lake City, UT (200K)

### 2. ‚úÖ Built Enhanced Script
Created `scripts/rediscover-top-cities.js` that:
- **Loads cities from `data/top_30_rediscovery_cities.json`** (generated by `scripts/get-top-rediscovery-cities.js`)
- Uses 9 search queries (vs 5 in optimized):

**Features:**
- 9 search queries (vs 5 in optimized):
  - non-alcoholic bar
  - mocktail bar
  - kava bar
  - **alcohol-free restaurant** ‚Üê Added
  - sober bar
  - **zero proof cocktails** ‚Üê Added
  - **THC lounge** ‚Üê Added
  - **hemp drink bar** ‚Üê Added
  - **Athletic Brewing taproom** ‚Üê Added

- Optimized APIs (cost savings):
  - Find Place From Text ($17/1k) instead of Text Search ($32/1k)
  - CID extraction for direct Place Details
  - Batch AI verification (1 call per city)
  - Search result caching

- Complete data enrichment:
  - Auto-generates descriptions using Gemini AI
  - Fetches images from Places API photos
  - Gets contact info (phone, website)
  - Ensures `data_complete = true` for all new venues

## üìã Remaining Steps

### 3. ‚è≥ Run Script on Top 30 Cities
```bash
# Test run (3 cities)
node scripts/rediscover-top-cities.js --test --limit=3

# Full run (all 30 cities)
node scripts/rediscover-top-cities.js --apply
```

**Expected:**
- Better venue discovery (9 queries vs 5)
- Complete data for all new venues (description + image)
- Cost: ~$30-50 for 30 cities (vs $40-55 for 237 cities)

### 4. ‚è≥ Verify Results
- Check `data/rediscovery_results/` for new venue files
- Review venue counts per city
- Verify data completeness (all should have description + image)

### 5. ‚è≥ Upsert to Database
Use existing `scripts/upsert-enriched-venues.js` or create new script:
```bash
node scripts/upsert-enriched-venues.js --apply
```

**Note:** The new script already enriches venues with complete data, so they should be ready for direct upsert.

## üéØ Expected Outcomes

### For Seattle Specifically:
- **Current:** 2 venues
- **Expected:** 10-20+ venues (with 9 search queries)
- **Coverage:** Should find venues in categories like:
  - Alcohol-free restaurants
  - THC lounges (legal in Washington)
  - Zero-proof cocktail bars
  - Hemp drink bars

### Overall:
- Better coverage in all 30 major cities
- Complete data for all new venues (no missing descriptions/images)
- Ready for immediate database upsert

## üìä Cost Estimate

**Per City:**
- Search API: ~9 queries √ó $0.005 = $0.045 (after free tier)
- Places API: ~15-20 calls √ó $0.017 = $0.26-0.34
- Gemini: ~2 calls √ó $0.002 = $0.004
- **Total per city: ~$0.31-0.39**

**30 Cities:**
- **Total: ~$9-12** (very reasonable!)

## üöÄ Next Steps

1. Run test on 3 cities to verify script works
2. Review results and adjust if needed
3. Run full script on all 30 cities
4. Verify data completeness
5. Upsert to database
